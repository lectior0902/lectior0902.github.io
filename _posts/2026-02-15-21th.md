---
layout: single
published: true
title: "26.02.12. 데일리미션: 데이터 모델링 입문 - SQL 개발자3"
---

# SQLite3을 활용한 다양한 데이터베이스 분석


## 상권 데이터와 인구 데이터를 조인

### 상가업소정보_2025 테이블과 주민등록인구및세대현황 테이블을 조인

```python
select distinct 시도명 || ' ' || 시군구명
from 상가업소정보_2025
```
 
<img width="579" height="348" alt="그림1" src="https://github.com/user-attachments/assets/1628a3db-61d6-4c60-bc28-22a54657a07a" />


### 시군구별 매장수와 인구수 구하기

```python
SELECT 
    매장.시도명, 
    매장.총매장수, 
    인구.총인구수
FROM
    -- 1. 매장 정보를 '시도명' 단위로만 합침
    (SELECT 시도명, COUNT(*) AS 총매장수
     FROM 상가업소정보_2025
     WHERE 상호명 LIKE '공차%'
     GROUP BY 시도명) AS 매장
JOIN 
    -- 2. 인구 정보
    (SELECT 행정기관, 총인구수
     FROM 주민등록인구및세대현황) AS 인구
ON 
    -- 3. 시도명으로만 결합
    인구.행정기관 LIKE 매장.시도명 || '%'
WHERE 매장.시도명 IN ('서울특별시', '경기도', '인천광역시', '광주광역시');
```

 
<img width="602" height="320" alt="그림2" src="https://github.com/user-attachments/assets/5d36e16a-44ba-450c-8c47-4363b329fd41" />


### 매장 당 인구수 구하기
시도 단위로 바꾸어서 함

<img width="602" height="318" alt="그림3" src="https://github.com/user-attachments/assets/3782ce26-dc88-4150-83f0-6fe9e86f0f3e" />

 
렉이 너무 많이 걸려서 데이터구조를 잘 살펴보지 못했는데 시군구행이 있는데 기초자치단체 단위로 인식이 안 되는 게 데이터를 잘못 다운로드 받았거나… 뭔가 데이터형식이 위키독스 내용이랑 달라서 내가 잘못한 것일 것 같은데 일단 시도별로 묶어서 해보았다


# 데이터전처리하기

<img width="602" height="320" alt="그림4" src="https://github.com/user-attachments/assets/8051ece0-df14-4e58-ad38-e624ca9af7e6" />


51개 데이터가 겹침

<img width="602" height="320" alt="그림5" src="https://github.com/user-attachments/assets/fa8aed31-fdc9-495f-adf6-38831a22078e" />

```python
UPDATE 전국전기차충전소표준데이터
SET 휴점일2 = CASE
    WHEN 휴점일 IN ('-', 'X', 'x', 'N', '0', '무', '무휴', '없음', '없 음', '연중', '연중 무휴', '연중무휴', '연중무휴(주중08~20시, 주말09~18시 운영)', '연중휴무', '충전기 운영 휴무일 없음', '해당없음', '24시간운영') THEN '연중무휴'
    WHEN 휴점일 IN ('명절당일', '설날, 추석 당일', '매년 추석 및 구정') THEN '명절당일'
    WHEN 휴점일 IN ('공휴일', '법정 공휴일', '법정공휴일', '국경일,휴일') THEN '공휴일'
    WHEN 휴점일 IN ('일요일', '매주 일요일') THEN '일요일'
    WHEN 휴점일 IN ('매주 토.일', '주말', '토,일', '토일', '토,일요일', '토요일, 일요일', '매주 토,일', '토,일') THEN '토,일요일'
    WHEN 휴점일 IN ('매주 토/일요일 공휴일', '법정공휴일, 토요일, 일요일', '매주 토,일요일, 공휴일', '주말및공휴일', '주말 및 공휴일', '주말, 공휴일', '토,일,공휴일', '토, 일, 공휴일', '평일(주말, 공휴일 휴무)', '일·공휴일', '토요일,공휴일') THEN '토,일,공휴일'
    WHEN 휴점일 IN ('2주, 4주 일요일', '2주,4주 일요일', '2,4째주 일요일', '2,4째 일요일', '2, 4째주 일요일', '2/4주 일요일', '둘째, 넷째 일요일', '둘째,넷째 일요일', '둘째,넷째일요일', '매월2,4주일요일', '매월 2,4주 일요일', '매월2, 4째주 일요일', '매월2/4주일요일', '매월 2, 4주 일요일', '매월2,4주 일요일', '매주 2주 일요일+4주 일요일', '매월 둘째, 넷째주 일요일', '매월 10일, 4주일요일', '매월2, 4주일요일', '매월2,4', '2, 4째주 일요일') THEN '2,4주 일요일'
    WHEN 휴점일 IN ('둘째,넷째 수요일', '매월 2,4주 수요일', '매월2,4주 수요일', '매월2,4주수요일', '매월 둘째, 넷째 수요일 휴무', '매월2,4주 수요일') THEN '2,4주 수요일'
    WHEN 휴점일 IN ('둘째,넷째 월요일') THEN '2,4주 월요일'
    WHEN 휴점일 IN ('매월 4주째 월요일') THEN '4주 월요일'
    WHEN 휴점일 IN ('매월세째주월요일') THEN '3주 월요일'
    WHEN 휴점일 IN ('마트휴무일', '마트휴점일', '휴무일', '휴점일') THEN '휴점일'
    WHEN 휴점일 IN ('고객외 이용불가', '기타', '두번째금요일, 네번째토요일 휴무', '별도확인', '사용가능', '사용불가', 'o', '업무시간내', '영업시간내', '일요일, 토요일15:30', '입주민외 이용불가', '입주자외 이용불가', '자체운영', '주중,주말', '평일', '토, 일 휴일 이용불가', '평일 18시~익일07시, 주말공휴일') THEN '기타'
    ELSE 휴점일
END;
``` 

<img width="602" height="338" alt="그림6" src="https://github.com/user-attachments/assets/3677719c-cd02-47c4-994d-2e0cbe8468ac" />


첫 번째 레코드 조회
<img width="602" height="320" alt="그림7" src="https://github.com/user-attachments/assets/61cb0d2c-cc33-4298-85e4-9b431aecdc66" />


851에 해당하는 새(Eric)와 관련된 데이터를 모두 추출
<img width="602" height="321" alt="그림8" src="https://github.com/user-attachments/assets/bf047ef8-e0c8-4ddb-a753-3e8d8e995bcd" />
 
3개의 추적장치로부터 얻은 데이터임을 확인
<img width="602" height="321" alt="그림9" src="https://github.com/user-attachments/assets/8f7bd22f-9d23-4cf6-832c-2c921c965d29" />


에릭에 해당되는 데이터수 조회
<img width="602" height="318" alt="그림10" src="https://github.com/user-attachments/assets/241d4d0c-5d40-48ac-937c-ab2173203b40" />



에릭의 추적 시작 일시와 종료일시 조회(datetime이 TEXT로 되어있으므로 INT로 변환)
<img width="602" height="320" alt="그림11" src="https://github.com/user-attachments/assets/f2ab81b7-2332-46ee-9b92-feedf6e9cd83" />



추적장치별, 월별로 몇 건의 데이터가 있는지 집계
<img width="602" height="319" alt="그림12" src="https://github.com/user-attachments/assets/db528cf9-179a-4583-93ac-902bf3e8e15d" />




추적장치별, 월별로 몇 건의 데이터가 있는지 집계
