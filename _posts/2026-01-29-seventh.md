---
layout: single
title:  "26.01.29 데일리미션: 데이터 시각화"
---

# drop_duplicates, concat, drop/truncate, copy, pop, insert, +)label 변경




```python
from google.colab import drive
drive.mount('/content/drive')
```


```python
!jupyter nbconvert --to markdown "/content/drive/MyDrive/구름 생성AI/구름exp/26.01.29 데일리미션.ipynb"
```

# **kaggle dataset**

- <Student Social Media & Relationships>
- The Student Social Media & Relationships dataset contains anonymized records of students’ social‐media behaviors and related life outcomes. It spans multiple countries and academic levels, focusing on key dimensions such as usage intensity, platform preferences, and relationship dynamics. Each row represents one student’s survey response, offering a cross‐sectional snapshot suitable for statistical analysis and machine‐learning applications.


```python
import pandas as pd
```


```python
# Kaggle 데이터 로드
df = pd.read_csv('/Students Social Media Addiction.csv')
print("데이터 크기:", df.shape)
```

    데이터 크기: (705, 13)


## **중복행 제거(drop_duplicates) 구현**


```python
# 모든 열 검사

print(df.drop_duplicates())
```

         Student_ID  Age  Gender Academic_Level     Country  \
    0             1   19  Female  Undergraduate  Bangladesh   
    1             2   22    Male       Graduate       India   
    2             3   20  Female  Undergraduate         USA   
    3             4   18    Male    High School          UK   
    4             5   21    Male       Graduate      Canada   
    ..          ...  ...     ...            ...         ...   
    700         701   20  Female  Undergraduate       Italy   
    701         702   23    Male       Graduate      Russia   
    702         703   21  Female  Undergraduate       China   
    703         704   24    Male       Graduate       Japan   
    704         705   19  Female  Undergraduate      Poland   
    
         Avg_Daily_Usage_Hours Most_Used_Platform Affects_Academic_Performance  \
    0                      5.2          Instagram                          Yes   
    1                      2.1            Twitter                           No   
    2                      6.0             TikTok                          Yes   
    3                      3.0            YouTube                           No   
    4                      4.5           Facebook                          Yes   
    ..                     ...                ...                          ...   
    700                    4.7             TikTok                           No   
    701                    6.8          Instagram                          Yes   
    702                    5.6             WeChat                          Yes   
    703                    4.3            Twitter                           No   
    704                    6.2           Facebook                          Yes   
    
         Sleep_Hours_Per_Night  Mental_Health_Score Relationship_Status  \
    0                      6.5                    6     In Relationship   
    1                      7.5                    8              Single   
    2                      5.0                    5         Complicated   
    3                      7.0                    7              Single   
    4                      6.0                    6     In Relationship   
    ..                     ...                  ...                 ...   
    700                    7.2                    7     In Relationship   
    701                    5.9                    4              Single   
    702                    6.7                    6     In Relationship   
    703                    7.5                    8              Single   
    704                    6.3                    5              Single   
    
         Conflicts_Over_Social_Media  Addicted_Score  
    0                              3               8  
    1                              0               3  
    2                              4               9  
    3                              1               4  
    4                              2               7  
    ..                           ...             ...  
    700                            2               5  
    701                            5               9  
    702                            3               7  
    703                            2               4  
    704                            4               8  
    
    [705 rows x 13 columns]



```python
# Student_ID를 기준으로 중복된 것이 없는지 검사

df = df.drop_duplicates(subset=['Student_ID'], keep='first')
print(df)
```

         Student_ID  Age  Gender Academic_Level     Country  \
    0             1   19  Female  Undergraduate  Bangladesh   
    1             2   22    Male       Graduate       India   
    2             3   20  Female  Undergraduate         USA   
    3             4   18    Male    High School          UK   
    4             5   21    Male       Graduate      Canada   
    ..          ...  ...     ...            ...         ...   
    700         701   20  Female  Undergraduate       Italy   
    701         702   23    Male       Graduate      Russia   
    702         703   21  Female  Undergraduate       China   
    703         704   24    Male       Graduate       Japan   
    704         705   19  Female  Undergraduate      Poland   
    
         Avg_Daily_Usage_Hours Most_Used_Platform Affects_Academic_Performance  \
    0                      5.2          Instagram                          Yes   
    1                      2.1            Twitter                           No   
    2                      6.0             TikTok                          Yes   
    3                      3.0            YouTube                           No   
    4                      4.5           Facebook                          Yes   
    ..                     ...                ...                          ...   
    700                    4.7             TikTok                           No   
    701                    6.8          Instagram                          Yes   
    702                    5.6             WeChat                          Yes   
    703                    4.3            Twitter                           No   
    704                    6.2           Facebook                          Yes   
    
         Sleep_Hours_Per_Night  Mental_Health_Score Relationship_Status  \
    0                      6.5                    6     In Relationship   
    1                      7.5                    8              Single   
    2                      5.0                    5         Complicated   
    3                      7.0                    7              Single   
    4                      6.0                    6     In Relationship   
    ..                     ...                  ...                 ...   
    700                    7.2                    7     In Relationship   
    701                    5.9                    4              Single   
    702                    6.7                    6     In Relationship   
    703                    7.5                    8              Single   
    704                    6.3                    5              Single   
    
         Conflicts_Over_Social_Media  Addicted_Score  
    0                              3               8  
    1                              0               3  
    2                              4               9  
    3                              1               4  
    4                              2               7  
    ..                           ...             ...  
    700                            2               5  
    701                            5               9  
    702                            3               7  
    703                            2               4  
    704                            4               8  
    
    [705 rows x 13 columns]


#**concat 메소드 구현**


```python
# 위의 5개를 분리

top_df = df.head(5)
print(top_df)
```

       Student_ID  Age  Gender Academic_Level     Country  Avg_Daily_Usage_Hours  \
    0           1   19  Female  Undergraduate  Bangladesh                    5.2   
    1           2   22    Male       Graduate       India                    2.1   
    2           3   20  Female  Undergraduate         USA                    6.0   
    3           4   18    Male    High School          UK                    3.0   
    4           5   21    Male       Graduate      Canada                    4.5   
    
      Most_Used_Platform Affects_Academic_Performance  Sleep_Hours_Per_Night  \
    0          Instagram                          Yes                    6.5   
    1            Twitter                           No                    7.5   
    2             TikTok                          Yes                    5.0   
    3            YouTube                           No                    7.0   
    4           Facebook                          Yes                    6.0   
    
       Mental_Health_Score Relationship_Status  Conflicts_Over_Social_Media  \
    0                    6     In Relationship                            3   
    1                    8              Single                            0   
    2                    5         Complicated                            4   
    3                    7              Single                            1   
    4                    6     In Relationship                            2   
    
       Addicted_Score  
    0               8  
    1               3  
    2               9  
    3               4  
    4               7  



```python
# 아래 5개 분리

bottom_df = df.tail(5)
print(bottom_df)
```

         Student_ID  Age  Gender Academic_Level Country  Avg_Daily_Usage_Hours  \
    700         701   20  Female  Undergraduate   Italy                    4.7   
    701         702   23    Male       Graduate  Russia                    6.8   
    702         703   21  Female  Undergraduate   China                    5.6   
    703         704   24    Male       Graduate   Japan                    4.3   
    704         705   19  Female  Undergraduate  Poland                    6.2   
    
        Most_Used_Platform Affects_Academic_Performance  Sleep_Hours_Per_Night  \
    700             TikTok                           No                    7.2   
    701          Instagram                          Yes                    5.9   
    702             WeChat                          Yes                    6.7   
    703            Twitter                           No                    7.5   
    704           Facebook                          Yes                    6.3   
    
         Mental_Health_Score Relationship_Status  Conflicts_Over_Social_Media  \
    700                    7     In Relationship                            2   
    701                    4              Single                            5   
    702                    6     In Relationship                            3   
    703                    8              Single                            2   
    704                    5              Single                            4   
    
         Addicted_Score  
    700               5  
    701               9  
    702               7  
    703               4  
    704               8  



```python
# 둘을 합쳐보기

df_concat = pd.concat([top_df, bottom_df], axis=0)
print(df_concat)
```

         Student_ID  Age  Gender Academic_Level     Country  \
    0             1   19  Female  Undergraduate  Bangladesh   
    1             2   22    Male       Graduate       India   
    2             3   20  Female  Undergraduate         USA   
    3             4   18    Male    High School          UK   
    4             5   21    Male       Graduate      Canada   
    700         701   20  Female  Undergraduate       Italy   
    701         702   23    Male       Graduate      Russia   
    702         703   21  Female  Undergraduate       China   
    703         704   24    Male       Graduate       Japan   
    704         705   19  Female  Undergraduate      Poland   
    
         Avg_Daily_Usage_Hours Most_Used_Platform Affects_Academic_Performance  \
    0                      5.2          Instagram                          Yes   
    1                      2.1            Twitter                           No   
    2                      6.0             TikTok                          Yes   
    3                      3.0            YouTube                           No   
    4                      4.5           Facebook                          Yes   
    700                    4.7             TikTok                           No   
    701                    6.8          Instagram                          Yes   
    702                    5.6             WeChat                          Yes   
    703                    4.3            Twitter                           No   
    704                    6.2           Facebook                          Yes   
    
         Sleep_Hours_Per_Night  Mental_Health_Score Relationship_Status  \
    0                      6.5                    6     In Relationship   
    1                      7.5                    8              Single   
    2                      5.0                    5         Complicated   
    3                      7.0                    7              Single   
    4                      6.0                    6     In Relationship   
    700                    7.2                    7     In Relationship   
    701                    5.9                    4              Single   
    702                    6.7                    6     In Relationship   
    703                    7.5                    8              Single   
    704                    6.3                    5              Single   
    
         Conflicts_Over_Social_Media  Addicted_Score  
    0                              3               8  
    1                              0               3  
    2                              4               9  
    3                              1               4  
    4                              2               7  
    700                            2               5  
    701                            5               9  
    702                            3               7  
    703                            2               4  
    704                            4               8  


#**drop / truncate메소드 구현**


```python
# 분석과 비교적 상관없는 Country열을 삭제(시범으로 존재하지 않는 열 삭제)
# axis, inplace는 기본값이므로 생략 가능

df = df.drop(columns=['Country', 'Endurance'], axis = 0, inplace = False, errors='ignore')
print(df)
```

         Student_ID  Age  Gender Academic_Level  Avg_Daily_Usage_Hours  \
    0             1   19  Female  Undergraduate                    5.2   
    1             2   22    Male       Graduate                    2.1   
    2             3   20  Female  Undergraduate                    6.0   
    3             4   18    Male    High School                    3.0   
    4             5   21    Male       Graduate                    4.5   
    ..          ...  ...     ...            ...                    ...   
    700         701   20  Female  Undergraduate                    4.7   
    701         702   23    Male       Graduate                    6.8   
    702         703   21  Female  Undergraduate                    5.6   
    703         704   24    Male       Graduate                    4.3   
    704         705   19  Female  Undergraduate                    6.2   
    
        Most_Used_Platform Affects_Academic_Performance  Sleep_Hours_Per_Night  \
    0            Instagram                          Yes                    6.5   
    1              Twitter                           No                    7.5   
    2               TikTok                          Yes                    5.0   
    3              YouTube                           No                    7.0   
    4             Facebook                          Yes                    6.0   
    ..                 ...                          ...                    ...   
    700             TikTok                           No                    7.2   
    701          Instagram                          Yes                    5.9   
    702             WeChat                          Yes                    6.7   
    703            Twitter                           No                    7.5   
    704           Facebook                          Yes                    6.3   
    
         Mental_Health_Score Relationship_Status  Conflicts_Over_Social_Media  \
    0                      6     In Relationship                            3   
    1                      8              Single                            0   
    2                      5         Complicated                            4   
    3                      7              Single                            1   
    4                      6     In Relationship                            2   
    ..                   ...                 ...                          ...   
    700                    7     In Relationship                            2   
    701                    4              Single                            5   
    702                    6     In Relationship                            3   
    703                    8              Single                            2   
    704                    5              Single                            4   
    
         Addicted_Score  
    0                 8  
    1                 3  
    2                 9  
    3                 4  
    4                 7  
    ..              ...  
    700               5  
    701               9  
    702               7  
    703               4  
    704               8  
    
    [705 rows x 12 columns]


#**copy 메소드 구현**


```python
# 원본 데이터를 훼손하지 않기 위해 복사본 만들기
df_copied = df.copy()
print(df_copied)              # 완전히 똑같은 것 확인 가
```

         Student_ID  Age  Gender Academic_Level  Avg_Daily_Usage_Hours  \
    0             1   19  Female  Undergraduate                    5.2   
    1             2   22    Male       Graduate                    2.1   
    2             3   20  Female  Undergraduate                    6.0   
    3             4   18    Male    High School                    3.0   
    4             5   21    Male       Graduate                    4.5   
    ..          ...  ...     ...            ...                    ...   
    700         701   20  Female  Undergraduate                    4.7   
    701         702   23    Male       Graduate                    6.8   
    702         703   21  Female  Undergraduate                    5.6   
    703         704   24    Male       Graduate                    4.3   
    704         705   19  Female  Undergraduate                    6.2   
    
        Most_Used_Platform Affects_Academic_Performance  Sleep_Hours_Per_Night  \
    0            Instagram                          Yes                    6.5   
    1              Twitter                           No                    7.5   
    2               TikTok                          Yes                    5.0   
    3              YouTube                           No                    7.0   
    4             Facebook                          Yes                    6.0   
    ..                 ...                          ...                    ...   
    700             TikTok                           No                    7.2   
    701          Instagram                          Yes                    5.9   
    702             WeChat                          Yes                    6.7   
    703            Twitter                           No                    7.5   
    704           Facebook                          Yes                    6.3   
    
         Mental_Health_Score Relationship_Status  Conflicts_Over_Social_Media  \
    0                      6     In Relationship                            3   
    1                      8              Single                            0   
    2                      5         Complicated                            4   
    3                      7              Single                            1   
    4                      6     In Relationship                            2   
    ..                   ...                 ...                          ...   
    700                    7     In Relationship                            2   
    701                    4              Single                            5   
    702                    6     In Relationship                            3   
    703                    8              Single                            2   
    704                    5              Single                            4   
    
         Addicted_Score  
    0                 8  
    1                 3  
    2                 9  
    3                 4  
    4                 7  
    ..              ...  
    700               5  
    701               9  
    702               7  
    703               4  
    704               8  
    
    [705 rows x 12 columns]


#**pop 메소드 구현**


```python
# 'Addicted_Score'를 따로 저장
# 실수로 두 번 눌러서 에러뜸...

addicted_score = df_copied.pop('Addicted_Score')
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    /usr/local/lib/python3.12/dist-packages/pandas/core/indexes/base.py in get_loc(self, key)
       3804         try:
    -> 3805             return self._engine.get_loc(casted_key)
       3806         except KeyError as err:


    index.pyx in pandas._libs.index.IndexEngine.get_loc()


    index.pyx in pandas._libs.index.IndexEngine.get_loc()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    KeyError: 'Addicted_Score'

    
    The above exception was the direct cause of the following exception:


    KeyError                                  Traceback (most recent call last)

    /tmp/ipython-input-3205050549.py in <cell line: 0>()
          1 # 'Addicted_Score'를 따로 저장
          2 
    ----> 3 addicted_score = df_copied.pop('Addicted_Score')
    

    /usr/local/lib/python3.12/dist-packages/pandas/core/frame.py in pop(self, item)
       5817         3  monkey        NaN
       5818         """
    -> 5819         return super().pop(item=item)
       5820 
       5821     def _replace_columnwise(


    /usr/local/lib/python3.12/dist-packages/pandas/core/generic.py in pop(self, item)
        945 
        946     def pop(self, item: Hashable) -> Series | Any:
    --> 947         result = self[item]
        948         del self[item]
        949 


    /usr/local/lib/python3.12/dist-packages/pandas/core/frame.py in __getitem__(self, key)
       4100             if self.columns.nlevels > 1:
       4101                 return self._getitem_multilevel(key)
    -> 4102             indexer = self.columns.get_loc(key)
       4103             if is_integer(indexer):
       4104                 indexer = [indexer]


    /usr/local/lib/python3.12/dist-packages/pandas/core/indexes/base.py in get_loc(self, key)
       3810             ):
       3811                 raise InvalidIndexError(key)
    -> 3812             raise KeyError(key) from err
       3813         except TypeError:
       3814             # If we have a listlike key, _check_indexing_error will raise


    KeyError: 'Addicted_Score'



```python
print(addicted_score)
```

    0      8
    1      3
    2      9
    3      4
    4      7
          ..
    700    5
    701    9
    702    7
    703    4
    704    8
    Name: Addicted_Score, Length: 705, dtype: int64


#**insert 메소드 구현**


```python
# 새로운 변수를 담은 열 삽입
# Avg_Daily_Usage_Hours 열을 기준으로 3시간 이상이면 주의 단계로 설정


Social_Media_Overuse = df['Avg_Daily_Usage_Hours'] >= 3
```


```python
df_copied.insert(1, 'Social Media Overuse', Social_Media_Overuse, allow_duplicates=True)
```


```python
print(df_copied)
```

         Student_ID  Social Media Overuse  Age  Gender Academic_Level  \
    0             1                  True   19  Female  Undergraduate   
    1             2                 False   22    Male       Graduate   
    2             3                  True   20  Female  Undergraduate   
    3             4                  True   18    Male    High School   
    4             5                  True   21    Male       Graduate   
    ..          ...                   ...  ...     ...            ...   
    700         701                  True   20  Female  Undergraduate   
    701         702                  True   23    Male       Graduate   
    702         703                  True   21  Female  Undergraduate   
    703         704                  True   24    Male       Graduate   
    704         705                  True   19  Female  Undergraduate   
    
         Avg_Daily_Usage_Hours Most_Used_Platform Affects_Academic_Performance  \
    0                      5.2          Instagram                          Yes   
    1                      2.1            Twitter                           No   
    2                      6.0             TikTok                          Yes   
    3                      3.0            YouTube                           No   
    4                      4.5           Facebook                          Yes   
    ..                     ...                ...                          ...   
    700                    4.7             TikTok                           No   
    701                    6.8          Instagram                          Yes   
    702                    5.6             WeChat                          Yes   
    703                    4.3            Twitter                           No   
    704                    6.2           Facebook                          Yes   
    
         Sleep_Hours_Per_Night  Mental_Health_Score Relationship_Status  \
    0                      6.5                    6     In Relationship   
    1                      7.5                    8              Single   
    2                      5.0                    5         Complicated   
    3                      7.0                    7              Single   
    4                      6.0                    6     In Relationship   
    ..                     ...                  ...                 ...   
    700                    7.2                    7     In Relationship   
    701                    5.9                    4              Single   
    702                    6.7                    6     In Relationship   
    703                    7.5                    8              Single   
    704                    6.3                    5              Single   
    
         Conflicts_Over_Social_Media  
    0                              3  
    1                              0  
    2                              4  
    3                              1  
    4                              2  
    ..                           ...  
    700                            2  
    701                            5  
    702                            3  
    703                            2  
    704                            4  
    
    [705 rows x 12 columns]


#**+) label 변경하기**


```python
df_copied['Social Media Overuse'] = df_copied['Social Media Overuse'].replace({True: 'Caution', False: 'X'})
```


```python
print(df_copied)
```

         Student_ID Social Media Overuse  Age  Gender Academic_Level  \
    0             1              Caution   19  Female  Undergraduate   
    1             2                    X   22    Male       Graduate   
    2             3              Caution   20  Female  Undergraduate   
    3             4              Caution   18    Male    High School   
    4             5              Caution   21    Male       Graduate   
    ..          ...                  ...  ...     ...            ...   
    700         701              Caution   20  Female  Undergraduate   
    701         702              Caution   23    Male       Graduate   
    702         703              Caution   21  Female  Undergraduate   
    703         704              Caution   24    Male       Graduate   
    704         705              Caution   19  Female  Undergraduate   
    
         Avg_Daily_Usage_Hours Most_Used_Platform Affects_Academic_Performance  \
    0                      5.2          Instagram                          Yes   
    1                      2.1            Twitter                           No   
    2                      6.0             TikTok                          Yes   
    3                      3.0            YouTube                           No   
    4                      4.5           Facebook                          Yes   
    ..                     ...                ...                          ...   
    700                    4.7             TikTok                           No   
    701                    6.8          Instagram                          Yes   
    702                    5.6             WeChat                          Yes   
    703                    4.3            Twitter                           No   
    704                    6.2           Facebook                          Yes   
    
         Sleep_Hours_Per_Night  Mental_Health_Score Relationship_Status  \
    0                      6.5                    6     In Relationship   
    1                      7.5                    8              Single   
    2                      5.0                    5         Complicated   
    3                      7.0                    7              Single   
    4                      6.0                    6     In Relationship   
    ..                     ...                  ...                 ...   
    700                    7.2                    7     In Relationship   
    701                    5.9                    4              Single   
    702                    6.7                    6     In Relationship   
    703                    7.5                    8              Single   
    704                    6.3                    5              Single   
    
         Conflicts_Over_Social_Media  
    0                              3  
    1                              0  
    2                              4  
    3                              1  
    4                              2  
    ..                           ...  
    700                            2  
    701                            5  
    702                            3  
    703                            2  
    704                            4  
    
    [705 rows x 12 columns]

